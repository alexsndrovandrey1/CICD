# CICD

**CI/CD** — Это набор принципов и практик, которые позволяют чаще и надежнее развертывать изменения программного обеспечения.

**CI** (Continuous Integration) — в дословном переводе «непрерывная интеграция».
Имеется в виду интеграция отдельных кусочков кода приложения между собой.

**CD** (Continuous Delivery) — это расширение непрерывной интеграции, поскольку оно автоматически развертывает все изменения кода в тестовой и/или производственной среде после этапа сборки.

### Часть 1. Настройка **gitlab-runner**

- Поднимим виртуальную машину *Ubuntu Server 22.04 LTS*.

- Скачаем и установим на виртуальную машину **gitlab-runner**.

- Запустим **gitlab-runner** и зарегистрируем его для использования в текущем проекте (*DO6_CICD*).

### Часть 2. Сборка

- Напишем этап для **CI** по сборке приложений из проекта *SimpleBashUtils*.

- В файле _gitlab-ci.yml_ добавим этап запуска сборки через мейк файл из проекта *SimpleBashUtils*.

- Файлы, полученные после сборки (артефакты), сохраним в произвольную директорию со сроком хранения 30 дней.

### Часть 3. Тест кодстайла

- Напишем этап для **CI**, который запускает скрипт кодстайла (*clang-format*).

- Если кодстайл не прошел, то «зафейлим» пайплайн.

- В пайплайне отобразим вывод утилиты *clang-format*.

### Часть 4. Интеграционные тесты

- Напишем этап для **CI**, который запускает твои интеграционные тесты из того же проекта.

- Запустим этот этап автоматически только при условии, если сборка и тест кодстайла прошли успешно.

- Если тесты не прошли, то «зафейлим» пайплайн.

- В пайплайне отобразим вывод, что интеграционные тесты успешно прошли / провалились.

### Часть 5. Этап деплоя

- Поднимим вторую виртуальную машину *Ubuntu Server 22.04 LTS*.

- Напишем этап для **CD**, который «разворачивает» проект на другой виртуальной машине.

- Запустим этот этап вручную при условии, что все предыдущие этапы прошли успешно.

- Напишием bash-скрипт, который при помощи **ssh** и **scp** копирует файлы, полученные после сборки (артефакты), в директорию */usr/local/bin* второй виртуальной машины.

- В файле _gitlab-ci.yml_ добавим этап запуска написанного скрипта.

- В случае ошибки «зафейлим» пайплайн.

В результате ты должен получить готовые к работе приложения из проекта *SimpleBashUtils* (s21_cat и s21_grep) на второй виртуальной машине.

### Часть 6. Дополнительно. Уведомления

- Настрим уведомления о успешном/неуспешном выполнении пайплайна через бота с именем «leatrice DO6 CI/CD» в *Telegram* (https://t.me/leatrice_ci_cd_bot).

- Текст уведомления должен содержать информацию об успешности прохождения как этапа **CI**, так и этапа **CD**.

- В остальном текст уведомления может быть произвольным.